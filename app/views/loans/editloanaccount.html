<div class="col-md-12" ng-controller="EditLoanAccAppController">
    <div>
        <ul class="breadcrumb">
            <li ng-show="groupName"><a href="#!/viewgroup/{{groupId}}"><strong>{{groupName}}</strong></a></li>
            <li ng-show="clientName"><a href="#!/viewclient/{{clientId}}"><strong>{{clientName}}</strong></a></li>
            <li><a href="#!/viewloanaccount/{{loanaccountinfo.id}}">{{'loanaccountinfo.accountNo' | translate}}</a>
            </li>
            <li class="active">{{'label.anchor.modifyloanapplication' | translate}}</li>
        </ul>
    </div>
    <form name="editloanaccountform" novalidate="" class="well form-inline" rc-submit="submit()">
        <api-validate></api-validate>
        <table class="width100">
            <tr>
                <td class="width14">
                    <label>{{'label.input.product' | translate }}<span class="required">*</span>:</label>
                </td>
                <td class="width36 paddedbottom10">
                    <md-select id="productId" ng-model="formData.productId"
                        ng-change="loanProductChange(formData.productId)" placeholder="{{'label.selectloanproduct' | translate}}">
                        <md-option ng-repeat="product in loanaccountinfo.productOptions" ng-value="product.id">
                        {{product.name | translate}}
                        </md-option>
                    </md-select>
                </td>
                <td class="width14">
                    <label ng-show="formData.productId">{{'label.input.loanofficer' | translate }}:</label>
                </td>
                <td class="width36 paddedbottom10">
                    <md-select ng-show="formData.productId" id="loanOfficerId" 
                        ng-model="formData.loanOfficerId" placeholder="{{'label.selectloanofficer' | translate}}">
                        <md-option ng-repeat="loanOfficer in loanaccountinfo.loanOfficerOptions | orderBy:'displayName':reverse" 
                            ng-value="loanOfficer.id">
                        {{loanOfficer.displayName | translate}}
                        </md-option>
                    </md-select>
                </td>
            </tr>
            <tr ng-show="formData.productId">
                <td>
                    <label>{{'label.input.loanpurpose' | translate }}:</label>
                </td>
                <td class="paddedbottom10">
                    <md-select id="loanPurposeId" ng-model="formData.loanPurposeId">
                        <md-option><em>{{'label.selectpurpose' | translate}}</em></md-option>
                        <md-option ng-repeat="loanPurpose in loanaccountinfo.loanPurposeOptions | orderBy:'name':reverse" ng-value="loanPurpose.id"
                                ng-disabled="$index === 1">
                        {{loanPurpose.name | translate}}
                        </md-option>
                    </md-select>
                </td>
                <td ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.fundId == true">
                    <label>{{'label.input.fund' | translate }}:</label></td>
                <td class="paddedbottom10"
                    ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.fundId == true">
                    <md-select id="fundId" ng-model="formData.fundId">
                        <md-option><em>{{'label.selectfund' | translate}}</em></md-option>
                        <md-option ng-repeat="fund in loanaccountinfo.fundOptions" ng-value="fund.id"
                                ng-disabled="$index === 1">
                        {{fund.name | translate}}
                        </md-option>
                    </md-select>
                </td>
            </tr>
            <tr ng-show="formData.productId">
                <td>
                    <label>{{'label.input.submittedon' | translate }}<span class="required">*</span>:&nbsp;</label>
                </td>
                <td class="paddedbottom10">
                    <md-datepicker id="submittedOnDate" ng-model="formData.submittedOnDate" 
                        md-placeholder="{{'label.selecttodate' | translate}}"
                        md-min-date="'2000-01-01'" md-max-date="restrictDate">
                    </md-datepicker>
                </td>
                <td>
                    <label title="{{'label.input.expecteddisbursementon' | translate }}">{{'label.input.disbursementon' |
                translate }}<span class="required">*</span>:&nbsp;</label>
                </td>
                <td class="paddedbottom10">
                    <md-datepicker id="expectedDisbursementDate" ng-model="formData.expectedDisbursementDate" 
                        md-placeholder="{{'label.selecttodate' | translate}}" ng-disabled="disabled(date, mode)"
                        md-min-date="minDate" md-max-date="'2030-06-22'">
                    </md-datepicker>
                </td>
            </tr>
            <tr ng-show="formData.productId">
                <td><label>{{'label.input.externalid' | translate }}</label></td>
                <td class="paddedbottom10">
                    <input type="text" id="externalId" name="externalId" ng-model="formData.externalId"
                        class="form-control" />
                </td>
                <td></td>
                <td></td>
            </tr>
        </table>
        <div ng-hide="previewRepayment">
            <div ng-show="loanaccountinfo">
                <div ng-hide="loanaccountinfo.meeting == undefined">
                    <hr />
                </div>
                <legend ng-show="loanaccountinfo.calendarOptions"><i class="fa fa-calendar "></i>&nbsp;{{
            'label.heading.meetingdetails' | translate }}</legend>
                <table ng-show="loanaccountinfo.calendarOptions" class="width100">
                    <tr ng-repeat="calendar in loanaccountinfo.calendarOptions">
                        <td class="width14"><label>{{'label.heading.startdate' | translate }}:</label></td>
                        <td class="width36">{{calendar.startDate | DateFormat}}</td>
                        <td class="width14"><label>{{'label.heading.repeatson' | translate }}:</label></td>
                        <td class="width36">{{calendar.humanReadable}}</td>
                    </tr>
                    <tr ng-repeat="calendar in loanaccountinfo.calendarOptions">
                        <td align="center" colspan="2">
                            <md-checkbox ng-model="formData.syncRepaymentsWithMeeting" ng-change="syncRepaymentsWithMeetingchange()">
                                {{'label.input.syncrepaymentswithmeeting' | translate }}
                            </md-checkbox>
                        </td>
                        <td align="center" colspan="2">
                            <md-checkbox ng-model="formData.syncDisbursementWithMeeting" ng-change="syncDisbursementWithMeetingchange()">
                                {{'label.input.syncdisbursementdatewithmeeting' | translate }}
                            </md-checkbox>
                        </td>
                    </tr>
                </table>
                <div ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.linkAccountId == true">
                    <hr />
                </div>
                <div
                    ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.linkAccountId == true && response.uiDisplayConfigurations.loanAccount.isHiddenField.createStandingInstruction == true">
                    <legend
                        ng-show="loanaccountinfo">{{'label.heading.savingsLinkage' | translate }}</legend>
                </div>
                <table ng-show="loanaccountinfo" ng-hide="previewRepayment" class="width100">
                    <tr>
                        <td class="width19"
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.linkAccountId == true">
                            <label>{{'label.input.linksavings' | translate }}:</label>
                        </td>
                        <td class="width31 paddedbottom10"
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.linkAccountId == true">
                            <md-select id="linkAccountId" ng-model="formData.linkAccountId">
                                <md-option><em>{{'label.menu.selectone' | translate}}</em></md-option>
                                <md-option ng-repeat="savingaccount in loanaccountinfo.accountLinkingOptions" ng-value="savingaccount.id"
                                        ng-disabled="$index === 1">
                                {{savingaccount.productName | translate}}
                                </md-option>
                            </md-select>
                        </td>
                        <td colspan="2"
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.createStandingInstruction == true" >
                            <md-checkbox ng-model="formData.createStandingInstructionAtDisbursement">
                                {{'label.input.createStandingInstruction' | translate }}
                            </md-checkbox>
                        </td>
                    </tr>
                </table>
                <hr ng-show="loanaccountinfo" />
                <legend>{{'label.heading.terms' | translate }}</legend>
                <table class="width100">
                    <tr ng-show="errors!=''">
                        <td colspan="4">
                            <div class="alert alert-danger" >{{errors}}</div>
                        </td>
                    </tr>
                    <tr>
                        <td class="width19"><label>{{'label.input.principal' | translate }}&nbsp;<span
                                    class="required">*</span></label></td>
                        <td class="width31 paddedbottom10">
                            <div class="col-md-8">
                                <md-slider flex="95" class="md-primary" md-discrete ng-model="formData.principal" 
                                    step="{{loanaccountinfo.currency.inMultiplesOf}}" 
                                    min="{{loanaccountinfo.product.minPrincipal}}" 
                                    max="{{loanaccountinfo.product.maxPrincipal}}" id="principal-slider">
                                </md-slider>
                            </div>
                            <div class="col-md-4 left">
                                <label>{{loanaccountinfo.currency.displaySymbol}} {{formData.principal | FormatNumber}}</label>
                            </div>
                        </td>
                        <td class="width14"><label>{{'label.input.loanterm' | translate }}&nbsp;<span
                                    class="required">*</span>:</label>
                        </td>
                        <td class="width36 paddedbottom10">
                            <div class="col-sm-4">
                                <input id="loanTermFrequency" class="form-control" name="loanterm" type="number"
                                ng-model="formData.loanTermFrequency" required />
                            </div>
                            <div class="col-sm-8">
                                <md-select
                                    ng-disabled="response.uiDisplayConfigurations.loanAccount.isReadOnlyField.loanTermFrequencyType == true"
                                    id="loanTermFrequencyType" ng-model="formData.loanTermFrequencyType">
                                    <md-option ng-repeat="termFrequencyType in loanaccountinfo.termFrequencyTypeOptions" ng-value="termFrequencyType.id"
                                            ng-disabled="$index === 1">
                                    {{termFrequencyType.value | translate}}
                                    </md-option>
                                </md-select>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.numberOfRepayments == true">
                            <label>{{'label.input.numofrepayments' | translate }}&nbsp;<span
                                    class="required">*</span></label>
                        </td>
                        <td class="paddedbottom10"
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.numberOfRepayments == true">
                            <div class="col-md-6">
                                <input id="numberOfRepayments" class="form-control" name="numofrepayments" type="number"
                                ng-model="formData.numberOfRepayments" />
                            </div>
                        </td>
                        <td ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.repaymentEvery == true">
                            <label>{{'label.input.repaidevery' | translate }}&nbsp;<span
                                    class="required">*</span></label></td>
                        <td class="paddedbottom10"
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.repaymentEvery == true">
                            <div class="col-sm-3">
                                <input id="repaymentEvery" class="form-control" type="number" name="repaidevery"
                                    ng-model="formData.repaymentEvery"
                                    ng-disabled="!loanaccountinfo.product.allowAttributeOverrides.repaymentEvery" />
                            </div>
                            <div class="col-sm-3">
                                <md-select id="repaymentFrequencyType" ng-model="formData.repaymentFrequencyType"
                                    ng-disabled="!loanaccountinfo.product.allowAttributeOverrides.repaymentEvery">
                                    <md-option ng-repeat="repaymentFrequencyType in loanaccountinfo.termFrequencyTypeOptions" ng-value="repaymentFrequencyType.id">
                                    {{repaymentFrequencyType.value | translate}}
                                    </md-option>
                                </md-select>
                            </div>
                            <div class="col-sm-3">
                                <md-select id="repaymentFrequencyNthDayType" ng-model="formData.repaymentFrequencyNthDayType"
                                    ng-show="formData.repaymentFrequencyType == 2">
                                    <md-option><em>{{'label.menu.selectone' | translate}}</em></md-option>
                                    <md-option ng-repeat="repaymentFrequencyNthDayType in loanaccountinfo.repaymentFrequencyNthDayTypeOptions" ng-value="repaymentFrequencyNthDayType.id"
                                            ng-disabled="$index === 1">
                                    {{repaymentFrequencyNthDayType.value | translate}}
                                    </md-option>
                                </md-select>
                            </div>
                            <div class="col-sm-3">
                                <md-select id="repaymentFrequencyDayOfWeekType" ng-model="formData.repaymentFrequencyDayOfWeekType"
                                    ng-show="formData.repaymentFrequencyType == 2">
                                    <md-option><em>{{'label.selectday' | translate}}</em></md-option>
                                    <md-option ng-repeat="repaymentFrequencyDayOfWeekType in loanaccountinfo.repaymentFrequencyDaysOfWeekTypeOptions" 
                                        ng-value="repaymentFrequencyDayOfWeekType.id" ng-disabled="$index === 1">
                                    {{repaymentFrequencyDayOfWeekType.value | translate}}
                                    </md-option>
                                </md-select>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.repaymentsStartingFromDate == true">
                            <label>{{'label.input.firstrepaymenton' | translate }}</label></td>
                        <td class="paddedbottom10"
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.repaymentsStartingFromDate == true">
                            <md-datepicker id="repaymentsStartingFromDate" ng-model="formData.repaymentsStartingFromDate" 
                                md-placeholder="{{'label.selecttodate' | translate}}"
                                md-min-date="minDate" md-max-date="'2030-06-22'">
                            </md-datepicker>
                        </td>
                        <td
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.interestChargedFromDate == true">
                            <label class="control-label">{{'label.input.interestchargedfrom' | translate }}:</label>
                        </td>
                        <td class="paddedbottom10"
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.interestChargedFromDate == true">
                            <md-datepicker id="interestChargedFromDate" ng-model="formData.interestChargedFromDate" 
                                md-placeholder="{{'label.selecttodate' | translate}}"
                                md-min-date="minDate" md-max-date="'2030-06-22'">
                            </md-datepicker>
                        </td>
                    </tr>

                    <tr ng-show="!loanaccountinfo.isLoanProductLinkedToFloatingRate">
                        <td><label>{{'label.input.nominalinterestrate' | translate }}&nbsp;<span
                                    class="required">*</span></label></td>
                        <td class="paddedbottom10">
                            <div class="col-md-6">
                                <input id="interestRatePerPeriod" class="form-control" type="number"
                                    name="nominalinterestrate"
                                    ng-model="formData.interestRatePerPeriod" />
                            </div>
                            <div class="col-md-2">
                                {{loanaccountinfo.interestRateFrequencyType.value | translate}}
                            </div>
                        </td>
                        <td ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.interestType == true">
                            <label>{{'label.input.interestmethod' | translate }}</label></td>
                        <td class="paddedbottom10"
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.interestType == true">
                            <md-select id="interestType" ng-model="formData.interestType"
                                ng-disabled="!loanaccountinfo.product.allowAttributeOverrides.interestType">
                                <md-option ng-repeat="interestType in loanaccountinfo.interestTypeOptions" ng-value="interestType.id">
                                {{interestType.value | translate}}
                                </md-option>
                            </md-select>
                        </td>
                    </tr>
                    <tr ng-show="loanaccountinfo.isLoanProductLinkedToFloatingRate">
                        <td><label>{{'label.heading.floatinginterestratedifferential' | translate }}&nbsp;<span
                                    class="required">*</span></label></td>
                        <td class="paddedbottom10">
                            <input id="interestratedifferential" class="form-control" type="number"
                                name="interestratedifferential" ng-model="formData.interestRateDifferential" />
                        </td>
                        <td ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.interestType == true">
                            <label>{{'label.input.interestmethod' | translate }}</label></td>
                        <td class="width36 paddedbottom10"
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.interestType == true">
                            <md-select id="interestType" ng-model="formData.interestType"
                                ng-disabled="!loanaccountinfo.product.allowAttributeOverrides.interestType"
                                class="form-control " value="{{interestType.id}}">
                                <md-option ng-repeat="interestType in loanaccountinfo.interestTypeOptions" ng-value="interestType.id">
                                {{interestType.value | translate}}
                                </md-option>
                            </md-select>
                            <md-checkbox id="isfloatingrate" ng-model="formData.isFloatingInterestRate">
                                {{'label.input.isfloatingrate' | translate }}
                            </md-checkbox>
                        </td>
                    </tr>

                    <tr>
                        <td
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.amortizationType == true">
                            <label>{{'label.input.amortization' | translate }}&nbsp;<span
                                    class="required">*</span>:</label>
                        </td>
                        <td class="paddedbottom10"
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.amortizationType == true">
                            <md-select id="amortizationType" ng-model="formData.amortizationType"
                                ng-disabled="!loanaccountinfo.product.allowAttributeOverrides.amortizationType">
                                <md-option ng-repeat="amortizationType in loanaccountinfo.amortizationTypeOptions" ng-value="amortizationType.id">
                                {{amortizationType.value | translate}}
                                </md-option>
                            </md-select>
                        </td>
                        <td ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.interestType == true" colspan="2">
                            <md-checkbox id="isEqualAmortization" ng-model="formData.isEqualAmortization">
                                {{'label.input.isequalamortization' | translate }}
                            </md-checkbox>
                        </td>
                    </tr>
                    <tr>
                        <td
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.interestCalculationPeriodType == true">
                            <label>{{'label.input.interestcalculationperiod' | translate }}&nbsp;<span
                                    class="required">*</span></label></td>
                        <td class="paddedbottom10"
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.interestCalculationPeriodType == true">
                            <md-select id="interestCalculationPeriodType" ng-model="formData.interestCalculationPeriodType"
                                ng-disabled="!loanaccountinfo.product.allowAttributeOverrides.interestCalculationPeriodType">
                                <md-option ng-repeat="interestCalculationPeriodType in loanaccountinfo.interestCalculationPeriodTypeOptions" 
                                    ng-value="interestCalculationPeriodType.id">
                                {{interestCalculationPeriodType.value | translate}}
                                </md-option>
                            </md-select>
                        </td>
                        <td colspan="2"
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.interestCalculationPeriodType == true || formData.interestCalculationPeriodType == 0">
                            <md-checkbox id="allowPartialPeriodInterestCalcualtion" ng-model="formData.allowPartialPeriodInterestCalcualtion"
                            ng-disabled="!loanaccountinfo.product.allowAttributeOverrides.interestCalculationPeriodType">
                                {{'label.input.allowpartialperiodinterestcalcualtion' | translate }}
                            </md-checkbox>
                        </td>
                    </tr>
                    <tr>
                        <td
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.inArrearsTolerance == true">
                            <label>{{'label.input.arearstolerance' | translate }}</label></td>
                        <td class="paddedbottom10"
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.inArrearsTolerance == true">
                            <input id="inArrearsTolerance" type="number" class="form-control"
                                ng-disabled="!loanaccountinfo.product.allowAttributeOverrides.inArrearsTolerance"
                                ng-model="formData.inArrearsTolerance"
                                number-format>
                        </td>
                        <td
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.graceOnInterestCharged == true">
                            <label>{{'label.input.interestfreeperiod' | translate }}</label></td>
                        <td class="paddedbottom10"
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.graceOnInterestCharged == true">
                            <input id="graceOnInterestCharged" type="number" class="form-control"
                                ng-model="formData.graceOnInterestCharged">
                        </td>
                    </tr>
                    <tr>
                        <td
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.transactionProcessingStrategyId == true">
                            <label>{{'label.input.repaymentstrategy' | translate }}&nbsp;<span
                                    class="required">*</span></label></td>
                        <td class="paddedbottom10"
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.transactionProcessingStrategyId == true">
                            <md-select id="transactionProcessingStrategyId" ng-model="formData.transactionProcessingStrategyId" 
                                ng-disabled="!loanaccountinfo.product.allowAttributeOverrides.transactionProcessingStrategyId">
                                <md-option ng-repeat="transactionProcessingStrategy in loanaccountinfo.transactionProcessingStrategyOptions" 
                                    ng-value="transactionProcessingStrategy.id">
                                {{transactionProcessingStrategy.name | translate}}
                                </md-option>
                            </md-select>
                        </td>
                        <td class="paddedbottom10"
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.graceOnArrearsAgeing == true">
                            <label>{{'label.input.grace' | translate }}&nbsp;{{'label.input.onduedate' | translate}}
                        </td>
                        <td class="paddedbottom10">
                            <input id="graceOnArrearsAgeing" type="number" class="form-control"
                                    ng-model="formData.graceOnArrearsAgeing"
                                    ng-disabled="!loanaccountinfo.product.allowAttributeOverrides.graceOnArrearsAgeing"></label>
                        </td>
                    </tr>
                    <tr>
                        <td class="paddedbottom10">
                            <label>{{'label.input.graceonprincipalpayment' | translate}}</label>
                        </td>
                        <td class="paddedbottom10">
                            <input
                                id="graceOnPrincipalPayment"  type="number" class="form-control"
                                ng-disabled="!loanaccountinfo.product.allowAttributeOverrides.graceOnPrincipalAndInterestPayment"
                                ng-model="formData.graceOnPrincipalPayment">
                        </td>
                        <td class="paddedbottom10">
                            <label
                                ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.graceOnInterestPayment == true">{{'label.input.graceoninterestpayment' |
                        translate}}</label>
                        </td>
                        <td class="paddedbottom10">
                            <input
                                    ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenField.graceOnInterestPayment == true"
                                    id="graceOnInterestPayment" type="number" class="form-control"
                                    ng-disabled="!loanaccountinfo.product.allowAttributeOverrides.graceOnPrincipalAndInterestPayment"
                                    ng-model="formData.graceOnInterestPayment">
                        </td>
                    </tr>
                    <tr data-ng-show="loanaccountinfo.canDefineInstallmentAmount">
                        <td colspan=2>
                            <label>{{'label.input.fixedemiamount' | translate }}:</label>&nbsp;
                            <input id="fixedEmiAmount" type="number" ng-model="formData.fixedEmiAmount"
                                class="form-control" number-format />&nbsp;
                        </td>
                    </tr>
                    <tr ng-show="loanaccountinfo.canUseForTopup">
                        <td colspan="2">
                            <md-checkbox id="isTopup" ng-model="formData.isTopup">
                                {{'label.heading.isTopup' | translate }}
                            </md-checkbox>
                        </td>
                        <td ng-show="formData.isTopup == true">
                            <label>{{'label.input.loanIdToClose' | translate }}</label></td>
                        <td class="width36 paddedbottom10" ng-show="formData.isTopup == true">
                            <md-select id="loanIdToClose" ng-model="formData.loanIdToClose">
                                <md-option ng-repeat="loanSummary in loanaccountinfo.clientActiveLoanOptions" 
                                    ng-value="loanSummary.id">
                                {{loanSummary.accountNo | translate}}
                                </md-option>
                            </md-select>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="4"
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenSection.interestRecalculationSection == true">
                            <hr>
                        </td>
                    </tr>
                    <tr
                        ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenSection.interestRecalculationSection == true">
                        <td>
                            <label class="control-label">{{'label.input.recalculateinterest' | translate }}</label>
                        </td>
                        <td class="paddedbottom10">
                            <label
                                class="control-label">{{ loanaccountinfo.isInterestRecalculationEnabled | translate }}</label>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>{{'label.input.daysinyears' | translate }}</label>
                        </td>
                        <td class="paddedbottom10">
                            <label>{{ loanaccountinfo.daysInYearType.value | translate}}</label>
                        </td>
                        <td>
                            <label>{{'label.input.daysinmonth' | translate }}</label>
                        </td>
                        <td class="paddedbottom10">
                            <label>{{ loanaccountinfo.daysInMonthType.value | translate }}</label>
                        </td>
                    </tr>
                    <tr data-ng-show="loanaccountinfo.isInterestRecalculationEnabled">
                        <td
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenSection.interestRecalculationSection == true">
                            <label>{{'label.input.interest.recalculation.reschdule.strategy' | translate }}</label>
                        </td>
                        <td class="paddedbottom10"
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenSection.interestRecalculationSection == true">
                            <label>{{ loanaccountinfo.interestRecalculationData.rescheduleStrategyType.value | translate}}</label>
                        </td>
                    </tr>
                    <tr data-ng-show="loanaccountinfo.isInterestRecalculationEnabled">
                        <td
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenSection.interestRecalculationSection == true">
                            <label
                                class="control-label">{{'label.input.interest.recalculation.compounding.method' | translate }}</label>
                        </td>
                        <td class="paddedbottom10"
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenSection.interestRecalculationSection == true">
                            <label>{{ loanaccountinfo.interestRecalculationData.interestRecalculationCompoundingType.value | translate}}</label>
                        </td>

                        <td
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenSection.interestRecalculationSection == true">
                            <label class="control-label">{{'label.input.frequency.for.recalculte.outstanding.principal' |
                        translate }}<span class="required">*</span></label>
                        </td>
                        <td class="paddedbottom10"
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenSection.interestRecalculationSection == true">
                            <label>{{ loanaccountinfo.interestRecalculationData.recalculationRestFrequencyType.value | translate}}</label>
                        </td>
                    </tr>
                    <tr
                        data-ng-show="loanaccountinfo.isInterestRecalculationEnabled && loanaccountinfo.interestRecalculationData.recalculationRestFrequencyType.id != 1">
                        <td
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenSection.interestRecalculationSection == true">
                            <label
                                class="control-label">{{'label.input.frequenc.interval.for.recalculte.outstanding.principal' | translate }}</label>
                        </td>
                        <td class="paddedbottom10"
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenSection.interestRecalculationSection == true">
                            <label>{{ loanaccountinfo.interestRecalculationData.recalculationRestFrequencyInterval}}</label>
                        </td>

                        <td
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenSection.interestRecalculationSection == true">
                            <label class="control-label">{{'label.input.frequenc.date.for.recalculte.outstanding.principal' |
                        translate }}<span class="required">*</span></label>
                        </td>
                        <td class="paddedbottom10"
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenSection.interestRecalculationSection == true">
                            <md-datepicker id="recalculationRestFrequencyDate" ng-model="formData.recalculationRestFrequencyDate" 
                                md-placeholder="{{'label.selecttodate' | translate}}"
                                md-min-date="'2000-01-01'" md-max-date="restrictDate">
                            </md-datepicker>
                        </td>
                    </tr>
                    <tr
                        data-ng-show="loanaccountinfo.isInterestRecalculationEnabled  && loanaccountinfo.interestRecalculationData.interestRecalculationCompoundingType.id != 0">
                        <td
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenSection.interestRecalculationSection == true">
                            <label class="control-label">{{'label.input.frequency.for.compounding' |
                        translate }}<span class="required">*</span></label>
                        </td>
                        <td class="paddedbottom10"
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenSection.interestRecalculationSection == true">
                            <label>{{ loanaccountinfo.interestRecalculationData.recalculationCompoundingFrequencyType.value | translate}}</label>
                        </td>
                    </tr>
                    <tr
                        data-ng-show="loanaccountinfo.isInterestRecalculationEnabled && loanaccountinfo.interestRecalculationData.interestRecalculationCompoundingType.id != 0 && loanaccountinfo.interestRecalculationData.recalculationCompoundingFrequencyType.id != 1">
                        <td
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenSection.interestRecalculationSection == true">
                            <label
                                class="control-label">{{'label.input.frequenc.interval.for.compounding' | translate }}</label>
                        </td>
                        <td class="paddedbottom10"
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenSection.interestRecalculationSection == true">
                            <label>{{ loanaccountinfo.interestRecalculationData.recalculationCompoundingFrequencyInterval}}</label>
                        </td>

                        <td
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenSection.interestRecalculationSection == true">
                            <label class="control-label">{{'label.input.frequenc.date.for.compounding' |
                        translate }}<span class="required">*</span></label>
                        </td>
                        <td class="paddedbottom10"
                            ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenSection.interestRecalculationSection == true">
                            <md-datepicker id="recalculationCompoundingFrequencyDate" ng-model="formData.recalculationCompoundingFrequencyDate" 
                                md-placeholder="{{'label.selecttodate' | translate}}"
                                md-min-date="'2000-01-01'" md-max-date="restrictDate">
                            </md-datepicker>
                        </td>
                    </tr>
                </table>
                <div ng-show="multiDisburseLoan">
                    <hr />
                    <legend>{{'label.heading.tranchedetails' | translate }}</legend>
                    <table class="width100">
                        <tr>
                            <td class="width14"><label>{{'label.input.outstandingloanbalance' | translate}}:</label>
                            </td>
                            <td class="width36 paddedbottom10">
                                <input id="maxOutstandingLoanBalance" type="number" class="form-control"
                                    ng-model="formData.maxOutstandingLoanBalance" number-format>&nbsp;
                                <a title="{{'label.button.addtranch' | translate }}" ng-click="addTranches()"><i
                                        class="fa fa-plus "></i></a>
                            </td>
                        </tr>
                    </table>
                    <table class="table width100" ng-show="formData.disbursementData.length>0">
                        <thead>
                            <tr class="graybg">
                                <th>{{'label.input.expecteddisbursementon' | translate}}</th>
                                <th>{{'label.input.principal' | translate}}</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="disbursementDetail in formData.disbursementData">
                                <td>
                                    <md-datepicker id="disbursementDetail[{{$index}}].expectedDisbursementDate" 
                                        ng-model="disbursementDetail.expectedDisbursementDate"
                                        md-placeholder="{{'label.input.expecteddisbursementon' | translate}}"
                                        md-min-date="minDate" md-max-date="'2030-06-22'">
                                    </md-datepicker>
                                </td>
                                <td>
                                    <input id="{{disbursementDetail[$index].principal}}" class="form-control"
                                        number-format type="number" ng-model="disbursementDetail.principal"
                                        placeholder="{{'label.input.principal' | translate}}">
                                </td>
                                <td><a ng-click="deleteTranches($index)"><i class="fa fa-times-circle fa-2x"></i></a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <hr />
                <div class="col-md-12">
                    <legend>{{'label.heading.charges' | translate }}</legend>
                    <md-select ng-model="chargeFormData.chargeId">
                        <md-option><em>{{'label.selectcharge' | translate}}</em></md-option>
                        <md-option ng-repeat="charge in loanaccountinfo.chargeOptions|filter:loanaccountinfo.currency.code:strict" 
                            ng-value="charge.id" ng-disabled="$index === 1">
                        {{charge.name + ',' + charge.currency.displaySymbol | translate}}
                        </md-option>
                    </md-select>
                    <a ng-click="addCharge()"><i class="fa fa-plus "></i></a>
                </div>
                <table class="table" class="width100" ng-show="charges.length>0">
                    <tr class="graybg">
                        <th>{{'label.heading.name' | translate}}</th>
                        <th>{{'label.heading.type' | translate}}</th>
                        <th>{{'label.heading.amount' | translate}}</th>
                        <th>{{'label.heading.collectedon' | translate}}</th>
                        <th>{{'label.heading.date' | translate}}</th>
                        <th>{{'label.heading.actions' | translate}}</th>
                    </tr>
                    <tr ng-repeat="charge in charges">
                        <td>{{charge.name}},{{charge.currency.displaySymbol}}</td>
                        <td>{{charge.chargeCalculationType.value | translate}}</td>
                        <td><input id="{{charges[$index].amount}}" class="form-control" number-format type="number"
                                ng-model="charge.amountOrPercentage" placeholder="{{'label.input.amount' | translate}}">
                        </td>
                        <td>{{charge.chargeTimeType.value | translate}}</td>
                        <td>
                            <md-datepicker id="charges[{{$index}}].duedate" 
                                ng-model="charge.dueDate"
                                md-placeholder="{{'label.input.duedate' | translate}}"
                                md-min-date="minDate" md-max-date="'2030-06-22'">
                            </md-datepicker>
                        </td>
                        <td><a ng-click="deleteCharge($index)"><i class="fa fa-times-circle fa-2x"></i></a></td>
                    </tr>
                </table>
                <div ng-show="loanaccountinfo.overdueCharges.length>0">
                    <legend>{{'label.heading.overduepenalitycharge' | translate }}</legend>
                    <table class="table" class="width100">
                        <tr class="graybg">
                            <th>{{'label.heading.name' | translate}}</th>
                            <th>{{'label.heading.type' | translate}}</th>
                            <th class="text-right" style="padding-right: 10px;">{{'label.heading.amount' | translate}}</th>
                            <th>{{'label.heading.collectedon' | translate}}</th>
                        </tr>
                        <tr ng-repeat="charge in loanaccountinfo.overdueCharges">
                            <td>{{charge.name}},{{charge.currency.displaySymbol}}</td>
                            <td>{{charge.chargeCalculationType.value | translate}}</td>
                            <td class="text-right" style="padding-right: 10px;">{{charge.currency.displaySymbol}}{{charge.amount| FormatNumber}}</td>
                            <td>{{charge.chargeTimeType.value | translate}}</td>
                        </tr>
                    </table>
                </div>
                <div class="col-md-12 paddedtop"
                    ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenSection.collateralSection == true">
                    <legend>{{'label.heading.collaterals' | translate }}</legend>
                    <div layout="row">
                        <div class="col-sm-4">
                            <md-select ng-model="collateralFormData.collateralIdTemplate">
                                <md-option ng-repeat="collateralTemplate in collateralTemplates" ng-value="collateralTemplate.name">
                                {{collateralTemplate.name | translate}}
                                </md-option>
                            </md-select>
                        </div>
                        <div class="col-sm-4">
                            <input class="form-control" type="number" ng-model="collateralFormData.collateralValueTemplate"
                                placeholder="{{'label.input.value' | translate}}">
                        </div>
                        <div class="col-sm-2">
                            <input type="text" ng-model="collateralFormData.collateralDescriptionTemplate" class="form-control"
                            placeholder="{{'label.input.description' | translate}}">
                        </div>
                        <div class="col-sm-2">
                            <a ng-click="addCollateral()">&nbsp;<i class="fa fa-plus"></i></a>
                        </div>
                    </div>
                </div>
                <div ng-hide="response.uiDisplayConfigurations.loanAccount.isHiddenSection.collateralSection == true">
                    <table class="table" class="width100" ng-show="collaterals.length>0">
                        <tr class="graybg">
                            <th>{{'label.heading.name' | translate}}</th>
                            <th>{{'label.heading.value' | translate}}</th>
                            <th>{{'label.heading.description' | translate}}</th>
                            <th>{{'label.heading.actions' | translate}}</th>
                        </tr>
                        <tr ng-repeat="collateral in collaterals">
                            <td><input type="text" class="form-control" ng-model="collateral.name" readonly></td>
                            <td><input id="{{collaterals[$index].value}}" type="number" class="form-control"
                                    ng-model="collateral.value"></td>
                            <td><input id="{{collaterals[$index].description}}" class="form-control" type="text"
                                    ng-model="collateral.description"
                                    placeholder="{{'label.input.description' | translate}}"></td>
                            <td><a ng-click="deleteCollateral($index)"><i class="fa fa-times-circle fa-2x"></i></a></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
        <br>
        <md-divider></md-divider>
        <div ng-show="loanaccountinfo">
            <md-button md-no-ink class="md-primary" ng-hide="previewRepayment"
                    ng-click="previewRepayments()"> {{'label.anchor.repaymentinfo' | translate}}  <i
                        class="fa fa-arrow-right"></i></md-button>
            <md-button md-no-ink class="md-primary" ng-show="previewRepayment"
                    ng-click="previewRepayment=!previewRepayment"><i
                    class="fa fa-arrow-left"></i>  {{'label.anchor.backtoloaninfo' | translate}}</md-button>
        </div>
        <div>
            <table class="table width100" ng-show="previewRepayment">
                <thead>
                    <th colspan="3" scope="col"></th>
                    <th colspan="3" scope="col">{{'label.heading.loanamountandbalance' | translate}}</th>
                    <th colspan="2" scope="col">{{'label.heading.totalcostofloan' | translate}}</th>
                    <th></th>
                </thead>
                <tbody>
                    <tr>
                        <td>#</td>
                        <td>{{'label.heading.date' | translate}}</td>
                        <td>{{'label.heading.days' | translate}}</td>
                        <td class="text-right">{{'label.heading.disbursement' | translate}}</td>
                        <td class="text-right">{{'label.heading.principaldue' | translate}}</td>
                        <td class="text-right">{{'label.heading.principalbalance' | translate}}</td>
                        <td class="text-right">{{'label.heading.interestdue' | translate}}</td>
                        <td class="text-right">{{'label.heading.taxes' | translate}}</td>
                        <td class="text-right">{{'label.heading.fees' | translate}}</td>
                        <td class="text-right">{{'label.heading.penalty' | translate}}</td>
                        <td class="text-right">{{'label.heading.due' | translate}}</td>
                    </tr>
                    <tr ng-repeat="period in repaymentscheduleinfo.periods">
                        <td>{{period.period}}</td>
                        <td>{{period.dueDate | DateFormat}}</td>
                        <td>{{period.daysInPeriod}}</td>
                        <td class="text-right">{{period.principalDisbursed| FormatNumber}}</td>
                        <td class="text-right">{{period.principalDue| FormatNumber}}</td>
                        <td class="text-right">{{period.principalLoanBalanceOutstanding| FormatNumber}}</td>
                        <td class="text-right">{{period.interestDue| FormatNumber}}</td>
                        <td class="text-right">{{period.taxOnInterestDue | FormatNumber}}</td>
                        <td class="text-right">{{period.feeChargesDue| FormatNumber}}</td>
                        <td class="text-right">{{period.penaltyChargesDue| FormatNumber}}</td>
                        <td class="text-right">{{period.totalDueForPeriod| FormatNumber}}</td>
                    </tr>
                </tbody>
                <tfoot class="ui-widget-header">
                    <tr>
                        <td colspan="2">{{'label.heading.total' | translate}}</td>
                        <td>{{repaymentscheduleinfo.loanTermInDays}}</td>
                        <td class="text-right">{{repaymentscheduleinfo.totalPrincipalDisbursed| FormatNumber}}</td>
                        <td class="text-right">{{repaymentscheduleinfo.totalPrincipalExpected| FormatNumber}}</td>
                        <td class="text-right"></td>
                        <td class="text-right">{{repaymentscheduleinfo.totalInterestCharged| FormatNumber}}</td>
                        <td class="text-right">{{repaymentscheduleinfo.totalTaxes| FormatNumber}}</td>
                        <td class="text-right">{{repaymentscheduleinfo.totalFeeChargesCharged| FormatNumber}}</td>
                        <td class="text-right">{{repaymentscheduleinfo.totalPenaltyChargesCharged| FormatNumber}}</td>
                        <td class="text-right">{{repaymentscheduleinfo.totalRepaymentExpected| FormatNumber}}</td>
                    </tr>
                </tfoot>
            </table>
        </div>
        <div class="col-md-12 center">
            <md-button id="cancel" type="reset" class="md-raised"
                ng-click="cancel()">{{'label.button.cancel' | translate}}</md-button>
            <md-button id="save" ng-click="submit()" class="md-raised md-primary" has-permission='UPDATE_LOAN'
                ng-show="loanaccountinfo">{{'label.button.save' |
        translate}}
            </md-button>
        </div>
    </form>
</div>