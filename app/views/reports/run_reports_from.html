<div class="card" ng-controller="RunReportsController">
    <div class="content">
        <div class="toolbar">
            <h5>{{'label.reports.name.' + reportName | translate}}</h5>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
        </div>
        <br>
        <div class="row">
            <div class="col-sm-12">
                <span style="margin-left: 10px;font-size:20px;">
                    <md-button md-no-ink class="md-primary pull-right" ng-show="checkStatus()"
                            ng-click="isCollapsed=!isCollapsed">
                        <i class="fa fa-chevron-down"></i>{{'label.button.parameters' | translate }}
                    </md-button>
                    <md-button data-ng-hide="hideChart" md-no-ink class="md-primary pull-right" ng-click="setTypePie()">
                        {{'label.input.piechart' | translate }}
                    </md-button>
                    <md-button data-ng-hide="hideChart" md-no-ink class="md-primary pull-right" ng-click="setTypeBar()">
                        <i class="fa fa-bar-chart-o"></i>  {{'label.input.barchart' | translate }}
                    </md-button>
                </span>
            </div>
        </div>

        <div class="row">
            <div ng-hide="isCollapsed" class="alert-block form-horizontal">
                <br>
        
                <div class="form-group info" ng-repeat="reportParam in reportParams">
                    <label class="control-label col-sm-2" for="{{reportParam.variable}}">{{ reportParam.label | translate}}</label>
        
                    <div class="col-sm-3">
                        <md-select id="{{reportParam.inputName}}" ng-model="formData[reportParam.inputName]"
                                ng-change="getDependencies(reportParam)" required
                                placeholder="{{'label.selectone' | translate}}">
                                <md-option ng-repeat="selectOption in reportParam.selectOptions"
                                    ng-value="selectOption.id">
                                    {{selectOption.name | translate}}
                                </md-option>
                        </md-select>
                    </div>
                </div>
                <div class="form-group info" ng-repeat="reportTextParam in reportTextParams">
                    <label class="control-label col-sm-2" for="{{reportTextParam.variable}}">{{ reportTextParam.label |
                        translate}}</label>
        
                    <div class="col-sm-3">
                        <input style="width: 257px" id="{{reportTextParam.inputName}}" type="text" ng-model="formData[reportTextParam.inputName]"
                            class="form-control" required late-Validate/>
                    </div>
                </div>
                <div class="form-group info" ng-repeat="reportDateParam in reportDateParams">
                    <label class="control-label col-sm-2" for="{{reportDateParam.variable}}">{{ reportDateParam.label |
                        translate}}</label>
        
                    <div class="col-sm-3">
                        <md-datepicker id="{{reportDateParam.inputName}}" ng-model="formData[reportDateParam.inputName]"
                            md-placeholder="{{'label.selecttodate' | translate}}" required
                            md-min-date="minDate" md-max-date="'2030-06-22'" md-date-filter="disabled(date, mode)">
                        </md-datepicker>
                    </div>
                </div>
                <div class="form-group info" ng-show="reportType == 'Pentaho' || reportType == 'Jasper' ">
                    <label class="control-label col-sm-2" for="outputType">{{'label.input.outputtype' | translate }}</label>
        
                    <div class="col-sm-3">
                        <md-select ng-model="formData.outputType" placeholder="{{'label.selectone' | translate}}">
                            <md-option ng-repeat="format in formats" ng-value="format.value">
                                {{'label.input.'+format.label | translate}}
                            </md-option>
                        </md-select>
                    </div>
                </div>
                <div class="form-group info">
                    <label class="control-label col-sm-2" for="decimalsChoice">{{'label.input.decimalplace' | translate }}</label>
                    <div class="col-sm-3">
                        <md-select id="decimalsChoice" ng-model="decimalsChoice"
                            placeholder="{{'label.selectone' | translate}}">
                            <md-option ng-repeat="decimal in decimals" ng-value="decimal">
                                {{decimal}}
                            </md-option>
                        </md-select>
                    </div>
                </div>
                <md-divider></md-divider>
                <section layout="row" layout-sm="column" layout-align="center center" layout-wrap>
                    <md-button class="md-raised md-primary" ng-click="runReport()">
                        <i class="fa fa-play"></i> {{'label.button.runreport' | translate }}
                    </md-button>
                </section>
            </div>
            <div style="visibility: hidden">
                <table>
                    <tr>
                        <td width="30%"></td>
                        <td>
                            <md-radio-group
                            ng-model="type"
                            class="md-primary"
                            >
                                <div flex>
                                <md-radio-button flex value="pie">{{'label.input.pie' | translate}}
                                </md-radio-button>
                                </div>
                                <div flex>
                                    <md-radio-button flex value="bar">{{'label.input.bar' | translate}}
                                    </md-radio-button>
                                </div>
                            </md-radio-group>
                        </td>
                    </tr>
                </table>
            </div>

            <div style="margin-left:-45px;overflow:auto">
                <div data-ng-hide="hideChart">
                    <div data-ng-show="type=='pie'">
                        <nvd3-pie-chart
                                data="chartData"
                                id="pie"
                                width="1100"
                                height="900"
                                x="xFunction()"
                                y="yFunction()"
                                tooltips="true"
                                showLegend="true"
                                showLabels="true"
                                labelType="percent">
                            <svg height="1300"></svg>
                        </nvd3-pie-chart>
                    </div>
                    <div style="margin-left: 100px" data-ng-show="type=='bar'">
                        <nvd3-multi-bar-chart
                                data="barData"
                                id="barchart"
                                width="1000"
                                height="600"
                                showValues="true"
                                tooltips="true"
                                rotateLabels="90">
                            <svg></svg>
                        </nvd3-multi-bar-chart>
                    </div>
                </div>
            </div>
            
            <div ng-hide="hideTable">
                
                <div class="pull-right" ng-show="reportType == 'Table'">
                    <button class="btn btn-s btn-primary" ng-csv="csvData">
                        <i class="fa fa-file "></i> {{'label.button.exportcsv' | translate }}
                    </button>
                </div>
            
                <div scroll>
                    <table style="width: 1200px;white-space:nowrap" class="table table-bordered" data-anchor>
                        <thead>
                        <tr class="graybg">
                            <th ng-repeat="columnHeader in reportData.columnHeaders">{{columnHeader.columnName}}</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr id="{{$index}}" ng-repeat="row in reportData.data track by $index">
                            <td ng-repeat="col in row.row track by $index">
                                <span ng-show="isDecimal($index)" class="amount">{{col | FormatNumber:decimalsChoice}}</span>
                                <span ng-hide="isDecimal($index)">{{col}}</span>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div uib-collapse="hidePentahoReport" class="row alert-block span tab-content">
                <br>
                <iframe id="rptLoadingFrame" ng-src="{{baseURL}}" frameborder="0" width="100%" height="600px"></iframe>
            </div> 
        </div>
    </div>
</div>